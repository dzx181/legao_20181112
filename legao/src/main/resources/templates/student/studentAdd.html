<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>studentAdd</title>
    <link href="css/bootstrap.css" type="text/css" rel="stylesheet"/>
    <link href="css/main.css" type="text/css" charset="UTF-8" rel="stylesheet"/>


</head>
<body>

<div
     id="content_box">
    <div id="schedule-box" class="boxshaw hidden "></div>
    <span class="glyphicon glyphicon-circle-arrow-right"></span>&nbsp;&nbsp;&nbsp;&nbsp;
    &nbsp;&nbsp;&nbsp;
    当前位置：学员管理&nbsp;&gt;&nbsp;添加学员
    <hr/>
    <!--添加成功字样-->
    <div id="addInfo"></div>
    <div id="error" style="color:#FF0000;font-size:14px ;height: 20px;"></div>
    <form id="studentform">
        <table id="student_tab" style="width: 100%">
            <tr>
                <td>校区：</td>
                <td>
                    <select class="inputCss" id="schoolArea_id" name="schoolAreaID">
                        <option value="">--请选择校区--</option>
                        <option th:value="${schoolArea.id}" th:each="schoolArea:${application.allSchoolArea}">
                            [[${schoolArea.name}]]
                        </option>

                    </select>
                </td>


                <td>家长姓名：</td>
                <td><input type="text" name="parentName" class="inputCss" style="width:205px;" placeholder="请输入学员的家长姓名"
                           id="student_parentName"/></td>
                <td>跟进人：</td>
                <td>
                    <select class="inputCss" id="follow_id" name="followID">
                        <option value="0">--请选择跟进人--</option>
                        <option th:value="${follow.id}" th:each="follow:${application.allemploy}">
                            [[${follow.name}]]
                        </option>
                    </select>
                </td>

            </tr>
            <tr style="height: 10px;">
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>姓&nbsp;名：</td>
                <td><input type="text" name="name" class="inputCss" style="width:205px;" placeholder="请输入学员姓名"
                           maxlength="20" id="student_name"/></td>
                <td>家长关系：</td>
                <td><input type="text" name="parentRelat" class="inputCss" style="width:205px;"
                           placeholder="请输入学员与家长的关系" id="student_parentRelat"/></td>


                <td>顾问：</td>
                <td>
                    <select class="inputCss" id="stu_advisor" name="advisor">
                        <option value="0">--请输入学员的顾问--</option>
                        <option th:value="${employ.name}" th:each="employ:${application.allemploy}">
                            [[${employ.name}]]
                        </option>
                    </select>
                </td>

            </tr>
            <tr style="height: 10px;">
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>昵&nbsp;称：</td>
                <td><input type="text" name="nickName" class="inputCss" style="width:205px;" placeholder="请输入学员昵称"
                           id="student_nickName" maxlength="18"/></td>

                <td>手&nbsp;机：</td>
                <td><input type="text" name="telphone" class="inputCss" style="width:205px;" placeholder="请输入学员联系手机号码"
                           id="student_phone"/></td>
                <td>市场人员：</td>
                <td><input type="text" name="markPeople" class="inputCss" style="width:205px;"
                           placeholder="请输入学员专属的市场人员" id="student_markPeople"/></td>


            </tr>
            <tr style="height: 10px;">
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>性别：</td>
                <td>
                    <select class="inputCss" id="sex" name="sex">
                        <option value="">--请选择性别--</option>
                        <option value="男">男</option>
                        <option value="女">女</option>
                    </select>

                </td>
                <td>备用电话：</td>
                <td><input type="text" name="sparePhone" class="inputCss" style="width:205px;"
                           placeholder="请输入联系学员的备用电话" id="student_sparePhone"/></td>
                <td>学员的老师：</td>
                <td>

                    <select class="inputCss" id="teacher_id" name="teacherName">
                        <option value="">--请选择老师--</option>
                        <option th:value="${teacherName.name}" th:each="teacherName:${application.allTeacherName}">
                            [[${teacherName.name}]]
                        </option>
                    </select>

                </td>





            </tr>
            <tr style="height: 10px;">
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>学&nbsp;校：</td>
                <td><input type="text" name="education" class="inputCss" style="width:205px;" placeholder="请输入学员学校"
                           id="student_education"/></td>

                <td>微信账号：</td>
                <td><input type="text" name="weChatID" class="inputCss" style="width:205px;" placeholder="请输入学员联系微信账号"
                           id="student_qqNum"/>&nbsp;
                </td>
                <td>重要程度：</td>
                <td>
                    <select name="importanceGrade" id="importanceGrade" style="height: 35px;" class="inputCss">
                        <option value="">----全部----</option>
                        <option value="1">重点</option>
                        <option value="2">优质</option>
                        <option value="3">会员</option>
                        <option value="4">一般</option>
                        <option value="5">放弃</option>
                        <option value="6">未知</option>
                    </select>
                </td>




            </tr>
            <tr style="height: 10px;">
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>出生日期：</td>
                <td><input type="text" name="birthday" class="inputCss" style="width:205px;" placeholder="请输入学员出生日期"
                           id="student_birthday"/></td>
                <td>地区：</td>
                <td><input type="text" name="area" class="inputCss" style="width:205px;" placeholder="请输入学员所在地区"
                           id="student_area"/></td>

                <td>来源：</td>
                <td><input type="text" name="source" class="inputCss" style="width:205px;" placeholder="请输入学员的来源方式"
                           id="student_source"/></td>



            </tr>
            <tr style="height: 10px;">
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td>学员状态：</td>
                <td>
                    <select name="status" id="status" style="height: 35px;" class="inputCss">
                        <option value="">----全部----</option>
                        <option value="1">新客户</option>
                        <option value="2">试听客户</option>
                        <option value="3">号码无效客户</option>
                        <option value="4">其他</option>
                    </select>
                </td>
                <td>期望时间：</td>
                <td><input type="text" name="willDate" class="inputCss" style="width:205px;" placeholder="请输入学员期望到课时间"
                           id="student_willDate"/></td>

                <td>基本情况：</td>
                <td><textarea rows="5" cols="23" id="baseSituation" name="baseSituation" maxlength="200"
                              placeholder="请输入学员的基本情况,输入长度不大于200的字符..." class="inputCss"></textarea></td>
            </tr>

            <tr style="height: 10px;">
                <td></td>
                <td></td>
                <td></td>
            </tr>

            <tr>
                <td colspan="5" align="center"><input type="button" value="添加" class="btn btn-success" id="addbtn"/>&nbsp;&nbsp;&nbsp;&nbsp;
                    <input type="reset" name="cancel" class="btn btn-danger" value="取消"/></td>
            </tr>
        </table>
        <!--隐藏域-->
        <input type="hidden" name="id"/>
    </form>
    <!-- 判断是否添加成功 -->
    <input type="hidden" th:value="${type}" id="typeInfo"/>
</div>

<script src="js/jquery-1.12.4.js" type="application/javascript" charset="UTF-8"></script>
<script src="js/bootstrap.js" type="application/javascript" charset="UTF-8"></script>
<script src="laydate/laydate.js" type="text/javascript"></script>
<script src="js/common.js" type="application/javascript" charset="UTF-8"></script>
<script type="text/javascript">
    /* type */
    $(function () {
        if ($("#typeInfo").val() == 'yes') {
            $("#addInfo").html('<h3 style="color: green;height: 30px;">添加成功</h3>');
        } else if ($("#typeInfo").val() == 'no') {
            $("#addInfo").html('<h3 style="color: green;height: 30px;">添加失败</h3>');
        }
        /* 定时清除添加成功字样 */
        setTimeout(function () {
            $("#addInfo").text('');
        }, 5000);

        //日期插件
        laydate.render({
            elem: '#student_birthday',
            theme: '#8D48F9'//指定元素
            , trigger: 'click'
        });
        laydate.render({
            elem: '#student_willDate',
            theme: '#8D48F9'//指定元素
            , trigger: 'click'
        });
    });


    $("#addbtn").click(function () {

        //获取表单值
        var name = $("#student_name").val();
        var sex = $("#sex").val();
        var schoolArea_id = $("#schoolArea_id").val();
        var phone = $("#student_phone").val();
        var student_parentName = $("#student_parentName").val();
        var importanceGrade = $("#importanceGrade").val();
        var follow_id = $("#follow_id").val();
        var student_source = $("#student_source").val();
        var teacher_id = $("#teacher_id").val();

        //为字段需要赋默认值
        var student_nickName = $("#student_nickName").val();
        var student_education = $("#student_education").val();
        var student_parentRelat = $("#student_parentRelat").val();
        var advisor = $("#stu_advisor").val();
        var student_sparePhone = $("#student_sparePhone").val();
        var student_qqNum = $("#student_qqNum").val();
        var student_birthday = $("#student_birthday").val();
        var status = $("#status").val();
        var student_willDate = $("#student_willDate").val();
        var baseSituation = $("#baseSituation").val();
        var student_markPeople = $("#student_markPeople").val();
        var student_area = $("#student_area").val();


        //创建正则模板
        var re = /[`~!@#$%^&*_+<>{}\\/'[\]]/im;
        var phone_regx = /^1(3|4|5|7|8)\d{9}$/;
        if (schoolArea_id.trim() == "") {
            $("#error").text("*请选择校区");
        }   else if (sex.trim() == "") {
            $("#error").text("*请选择性别");
        } else if (name.trim() == "") {
            $("#error").text("*姓名不能为空，请补充完整");
        } else if (re.test(name.trim())) {
            $("#error").text("*姓名存在`~!@#$%^&*_+<>{}\'[]/等的非法字符");
        } else if (phone.trim() == "") {
            $("#error").text("*手机不能为空，请补充完整");
        } else if (re.test(phone.trim())) {
            $("#error").text("*手机存在`~!@#$%^&*_+<>{}\'[]/等的非法字符");
        } else if (!phone_regx.test(phone.trim())) {
            $("#error").text("*输入的手机格式不对，请正确输入手机格式");
        }else if (teacher_id.trim() == "") {
            $("#error").text("*学员老师不能为空，请补充完整");
        }else {

            if (student_parentName.trim() == "") {
                $("#student_parentName").val("无")
            }
            if (importanceGrade.trim() == "") {
                $("#importanceGrade").val(6)
            }
            if (student_area.trim() == "") {
                $("#student_area").val("无");
            }
            if (student_markPeople.trim() == "") {
                $("#student_markPeople").val("无");
            }
            if (baseSituation.trim() == "") {
                $("#baseSituation").text("无");
            }
            if (student_source.trim() == "") {
                $("#student_source").val("无")
            }
            if (student_willDate.trim() == "") {
                $("#student_willDate").val(new Date().Format("yyyy-MM-dd"));
            }
            if (status.trim() == "") {
                $("#status").val("4");
            }
            if (student_birthday.trim() == "") {
                $("#student_birthday").val(new Date().Format("yyyy-MM-dd"));
            }
            if (student_qqNum.trim() == "") {
                $("#student_qqNum").val("无");
            }
            if (student_sparePhone.trim() == "") {
                $("#student_sparePhone").val("无");
            }
            if (student_parentRelat.trim() == "") {
                $("#student_parentRelat").val("无");
            }
            if (student_education.trim() == "") {
                $("#student_education").val("无");
            }
            if (student_nickName.trim() == "") {
                $("#student_nickName").val("无");
            }
            $("#studentform").attr("action", "insertStudent");
            $("#studentform").submit();
        }

    });

</script>

</body>
</html>
